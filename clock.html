<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>briankung.xyz - 阿公 clock</title>

  <style>
    body, html {
      background-color: black;
      height: 100%;
      display: grid;
    }

    svg {
      width: 100%;
      margin: auto;
    }

    text {
      font-family: 'SimSun', sans-serif;
      fill: #f8f8ff;
    }

    text tspan {
      font-size: x-small;
    }
  </style>
</head>
<body>
  <svg viewBox="0 0 53 18">
    <text id="clock" x="0" y="15"></text>
  </svg>
</body>
</html>

<script>
  const MILLISECONDS = 1000,
        ONE_SECOND = MILLISECONDS,
        ONE_MINUTE = MILLISECONDS * 60,
        clock = document.getElementById('clock');

  function setTime() {
    const date = new Date,
          timeString = date.toLocaleString(
            'zh-CN',
            {
              hour: 'numeric',
              minute: 'numeric',
              hour12: true
            }
          ),
          [_, ampm, time] = timeString.match(/^(.{2})(.+)$/),
          tspan = document.createElementNS("http://www.w3.org/2000/svg", "tspan");

    tspan.textContent = ampm;
    clock.textContent = time;
    clock.prepend(tspan);
  };

  setTime();

  window.setTimeout(
    () => window.setInterval(setTime, ONE_MINUTE),
    (ONE_MINUTE - ((new Date).getSeconds() * MILLISECONDS))
  )
</script>
